<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planify - Agenda Visual</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #10b981;
            --secondary-color: #3b82f6;
            --bg-dark: #111827;
            --bg-medium: #1f2937;
            --text-light: #f3f4f6;
            --text-medium: #9ca3af;
            --accent-red: #ef4444;
            --accent-purple: #8b5cf6;
            --shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

        body {
            background: linear-gradient(135deg, #111827, #1e3a8a, #4c1d95);
            background-size: 200% 200%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: var(--text-light);
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 24px;
            color: var(--primary-color);
            text-decoration: none;
            z-index: 1000;
        }

        .back-button:hover {
            transform: scale(1.1);
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .calendar {
            background: var(--bg-medium);
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .calendar-header {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .calendar-header::before {
            content: 'üìÖ';
            font-size: 2rem;
        }

        .calendar-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .view-controls {
            display: flex;
            gap: 15px;
        }

        .view-btn, .nav-btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            background: var(--bg-dark);
            color: var(--text-light);
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            position: relative;
        }

        .view-btn:hover::after, .nav-btn:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-dark);
            color: var(--text-light);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9rem;
            white-space: nowrap;
            z-index: 10;
        }

        .view-btn.active {
            background: linear-gradient(135deg, var(--accent-purple), #a78bfa);
            box-shadow: 0 0 12px rgba(139, 92, 246, 0.5);
        }

        .view-btn:hover, .nav-btn:hover {
            background: var(--accent-purple);
            transform: scale(1.05);
        }

        .nav-btn {
            background: linear-gradient(135deg, var(--secondary-color), #60a5fa);
        }

        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-dark);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .calendar-table th, .calendar-table td {
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .calendar-table th {
            background: linear-gradient(135deg, var(--bg-medium), #374151);
            font-weight: 600;
        }

        .calendar-table td {
            cursor: pointer;
            position: relative;
            transition: background 0.3s ease, border 0.3s ease;
        }

        .calendar-table td:hover {
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid var(--primary-color);
            animation: pulse 0.5s ease;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .event {
            background: var(--accent-purple);
            color: white;
            padding: 8px;
            border-radius: 6px;
            margin: 3px;
            font-size: 0.9rem;
            position: relative;
            text-align: left;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.3s ease-in;
        }

        .event.work {
            background: var(--primary-color);
        }

        .event.personal {
            background: var(--secondary-color);
        }

        .event-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--accent-purple);
            display: inline-block;
            margin: 3px;
            position: relative;
        }

        .event-dot.work {
            background: var(--primary-color);
        }

        .event-dot.personal {
            background: var(--secondary-color);
        }

        .event-dot:hover::after {
            content: attr(data-title);
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-dark);
            color: var(--text-light);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.9rem;
            white-space: nowrap;
            z-index: 10;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--bg-medium);
            border-radius: 16px;
            padding: 20px;
            width: 90%;
            max-width: 400px;
            box-shadow: var(--shadow);
            color: var(--text-light);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-content h2 {
            font-size: 1.6rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-content h2::before {
            content: '‚ú®';
        }

        .modal-content p {
            font-size: 0.9rem;
            color: var(--text-medium);
            margin-bottom: 15px;
        }

        .modal-content label {
            display: block;
            margin: 8px 0 4px;
            font-size: 1rem;
            font-weight: 600;
        }

        .modal-content input, .modal-content select {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: var(--bg-dark);
            color: var(--text-light);
            font-size: 1rem;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .modal-btn.save {
            background: linear-gradient(135deg, var(--primary-color), #34d399);
        }

        .modal-btn.save::before {
            content: '‚úî';
        }

        .modal-btn.cancel {
            background: linear-gradient(135deg, var(--accent-red), #ef4444);
        }

        .modal-btn.cancel::before {
            content: '‚úñ';
        }

        .modal-btn:hover {
            transform: scale(1.05);
        }

        .tooltip {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-dark);
            color: var(--text-light);
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            z-index: 2000;
            font-size: 1rem;
            text-align: center;
            max-width: 500px;
            animation: fadeIn 0.5s ease;
        }

        .tooltip button {
            margin-top: 10px;
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            .calendar-table th, .calendar-table td {
                padding: 10px;
                font-size: 0.9rem;
            }
            .event, .event-dot {
                font-size: 0.8rem;
            }
            .modal-content {
                padding: 15px;
                max-width: 90%;
            }
            .view-btn, .nav-btn {
                padding: 10px 15px;
                font-size: 1rem;
            }
            .calendar-header {
                font-size: 1.6rem;
            }
            .tooltip {
                font-size: 0.9rem;
                padding: 10px 15px;
            }
        }
    </style>
    </head>
<body>
    <a href="../index.html" class="back-button"><i class="fas fa-arrow-left"></i></a>
    <div class="container">
        <div class="calendar">
            <h1>Planify</h1>
            <div class="calendar-header" id="calendar-header"></div>
            <div class="calendar-controls">
                <div class="view-controls">
                    <button class="view-btn active" onclick="changeView('day')" data-tooltip="Ver un d√≠a a la vez"><span>üìÖ</span> D√≠a</button>
                    <button class="view-btn" onclick="changeView('week')" data-tooltip="Ver una semana completa"><span>üìÜ</span> Semana</button>
                    <button class="view-btn" onclick="changeView('month')" data-tooltip="Ver un mes completo"><span>üóìÔ∏è</span> Mes</button>
                </div>
                <div>
                    <button class="nav-btn" onclick="prevPeriod()" data-tooltip="Ir al per√≠odo anterior"><span>‚óÑ</span> Anterior</button>
                    <button class="nav-btn" onclick="nextPeriod()" data-tooltip="Ir al per√≠odo siguiente">Siguiente <span>‚ñ∫</span></button>
                </div>
            </div>
            <table class="calendar-table" id="calendar-table"></table>
        </div>
    </div>

    <div class="modal" id="event-modal">
        <div class="modal-content">
            <h2>Nuevo Evento</h2>
            <p>Programa un evento en un clic. Ejemplo: "Reuni√≥n" a las 10:00.</p>
            <label for="event-title">T√≠tulo</label>
            <input type="text" id="event-title" placeholder="Ejemplo: Reuni√≥n">
            <label for="event-datetime">Fecha y Hora</label>
            <input type="datetime-local" id="event-datetime">
            <label for="event-duration">Duraci√≥n (minutos)</label>
            <input type="number" id="event-duration" placeholder="Ejemplo: 60" value="60">
            <label for="event-category">Categor√≠a</label>
            <select id="event-category">
                <option value="work">Trabajo</option>
                <option value="personal">Personal</option>
            </select>
            <label for="event-reminder">Recordatorio (minutos antes)</label>
            <input type="number" id="event-reminder" placeholder="Ejemplo: 5" value="5">
            <div class="modal-buttons">
                <button class="modal-btn save" onclick="saveEvent()">Guardar</button>
                <button class="modal-btn cancel" onclick="closeModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <div class="tooltip" id="welcome-tooltip" style="display: none;">
        ¬°Bienvenido a Planify! Clic en una celda para crear un evento. Activa las notificaciones para recordatorios. <br>
        <button onclick="closeTooltip()">Entendido</button>
    </div>

    <script>
        let currentView = 'day';
        let currentDate = new Date();
        let events = [];

        // Inicializar la agenda
        function initAgenda() {
            // Mostrar tooltip de bienvenida
            if (!localStorage.getItem('planifyWelcomeShown')) {
                document.getElementById('welcome-tooltip').style.display = 'block';
                localStorage.setItem('planifyWelcomeShown', 'true');
            }

            // Solicitar permiso para notificaciones
            if (Notification.permission !== 'granted' && Notification.permission !== 'denied') {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        new Notification('¬°Notificaciones activadas!', {
                            body: 'Recibir√°s alertas para tus eventos en Planify.'
                        });
                    }
                });
            }

            loadEvents();
            renderCalendar();
            checkReminders();
            setInterval(checkReminders, 60000); // Revisar recordatorios cada minuto
        }

        // Cerrar tooltip de bienvenida
        function closeTooltip() {
            document.getElementById('welcome-tooltip').style.display = 'none';
        }

        // Actualizar el encabezado de fecha
        function updateHeader() {
            const header = document.getElementById('calendar-header');
            if (currentView === 'day') {
                header.textContent = currentDate.toLocaleDateString('es-ES', {
                    weekday: 'long', day: 'numeric', month: 'long', year: 'numeric'
                });
            } else if (currentView === 'week') {
                const startOfWeek = new Date(currentDate);
                startOfWeek.setDate(currentDate.getDate() - (currentDate.getDay() === 0 ? 6 : currentDate.getDay() - 1));
                const endOfWeek = new Date(startOfWeek);
                endOfWeek.setDate(startOfWeek.getDate() + 6);
                header.textContent = `Semana del ${startOfWeek.toLocaleDateString('es-ES', { day: 'numeric', month: 'long' })} al ${endOfWeek.toLocaleDateString('es-ES', { day: 'numeric', month: 'long', year: 'numeric' })}`;
            } else if (currentView === 'month') {
                header.textContent = currentDate.toLocaleDateString('es-ES', { month: 'long', year: 'numeric' });
            }
        }

        // Cambiar la vista del calendario
        function changeView(view) {
            currentView = view;
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.view-btn[onclick="changeView('${view}')"]`).classList.add('active');
            renderCalendar();
        }

        // Navegar al per√≠odo anterior
        function prevPeriod() {
            if (currentView === 'day') {
                currentDate.setDate(currentDate.getDate() - 1);
            } else if (currentView === 'week') {
                currentDate.setDate(currentDate.getDate() - 7);
            } else if (currentView === 'month') {
                currentDate.setMonth(currentDate.getMonth() - 1);
            }
            renderCalendar();
        }

        // Navegar al per√≠odo siguiente
        function nextPeriod() {
            if (currentView === 'day') {
                currentDate.setDate(currentDate.getDate() + 1);
            } else if (currentView === 'week') {
                currentDate.setDate(currentDate.getDate() + 7);
            } else if (currentView === 'month') {
                currentDate.setMonth(currentDate.getMonth() + 1);
            }
            renderCalendar();
        }

        // Renderizar el calendario
        function renderCalendar() {
            const table = document.getElementById('calendar-table');
            table.innerHTML = '';
            updateHeader();

            if (currentView === 'day') {
                renderDayView();
            } else if (currentView === 'week') {
                renderWeekView();
            } else if (currentView === 'month') {
                renderMonthView();
            }

            // A√±adir evento de clic para crear eventos
            table.addEventListener('click', handleCellClick);
        }

        // Renderizar vista de d√≠a
        function renderDayView() {
            const table = document.getElementById('calendar-table');
            const hours = Array.from({ length: 24 }, (_, i) => i);
            const dateStr = currentDate.toISOString().split('T')[0];

            let html = '<tr><th>Hora</th></tr>';
            hours.forEach(hour => {
                const time = `${hour.toString().padStart(2, '0')}:00`;
                html += `<tr><td data-time="${dateStr}T${time}:00">${time}</td></tr>`;
            });

            table.innerHTML = html;
            renderEvents();
        }

        // Renderizar vista de semana
        function renderWeekView() {
            const table = document.getElementById('calendar-table');
            const days = getWeekDays(currentDate);
            let html = '<tr><th></th>';
            days.forEach(day => {
                html += `<th>${day.toLocaleDateString('es-ES', { weekday: 'short', day: 'numeric' })}</th>`;
            });
            html += '</tr>';

            const hours = Array.from({ length: 24 }, (_, i) => i);
            hours.forEach(hour => {
                const time = `${hour.toString().padStart(2, '0')}:00`;
                html += `<tr><td>${time}</td>`;
                days.forEach(day => {
                    const dateStr = day.toISOString().split('T')[0];
                    html += `<td data-time="${dateStr}T${time}:00"></td>`;
                });
                html += '</tr>';
            });

            table.innerHTML = html;
            renderEvents();
        }

        // Renderizar vista de mes
        function renderMonthView() {
            const table = document.getElementById('calendar-table');
            const firstDayOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDayOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            const firstDayOfWeek = firstDayOfMonth.getDay() === 0 ? 7 : firstDayOfMonth.getDay(); // Lunes como primer d√≠a
            const daysInMonth = lastDayOfMonth.getDate();

            let html = '<tr>';
            ['Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b', 'Dom'].forEach(day => {
                html += `<th>${day}</th>`;
            });
            html += '</tr>';

            let date = 1;
            for (let i = 0; i < 6; i++) {
                html += '<tr>';
                for (let j = 1; j <= 7; j++) {
                    const cellIndex = i * 7 + j;
                    if (cellIndex < firstDayOfWeek || date > daysInMonth) {
                        html += '<td></td>';
                    } else {
                        const day = new Date(currentDate.getFullYear(), currentDate.getMonth(), date);
                        const dateStr = day.toISOString().split('T')[0];
                        html += `<td data-time="${dateStr}">${date}</td>`;
                        date++;
                    }
                }
                html += '</tr>';
                if (date > daysInMonth) break;
            }

            table.innerHTML = html;
            renderEvents();
        }

        // Obtener d√≠as de la semana
        function getWeekDays(date) {
            const startOfWeek = new Date(date);
            startOfWeek.setDate(date.getDate() - (date.getDay() === 0 ? 6 : date.getDay() - 1)); // Comenzar en lunes
            return Array.from({ length: 7 }, (_, i) => {
                const d = new Date(startOfWeek);
                d.setDate(startOfWeek.getDate() + i);
                return d;
            });
        }

        // Renderizar eventos en el calendario
        function renderEvents() {
            events.forEach(event => {
                const start = new Date(event.start);
                const end = new Date(event.end);
                const dateStr = start.toISOString().split('T')[0];

                if (currentView === 'month') {
                    const dayCells = document.querySelectorAll(`td[data-time="${dateStr}"]`);
                    dayCells.forEach(cell => {
                        if (cell) {
                            const eventEl = document.createElement('div');
                            eventEl.className = `event-dot ${event.category}`;
                            eventEl.setAttribute('data-title', event.title);
                            cell.appendChild(eventEl);
                        }
                    });
                } else {
                    const startHour = start.getHours();
                    const startMinutes = start.getMinutes();
                    const endHour = end.getHours();
                    const endMinutes = end.getMinutes();
                    const timeStr = `${dateStr}T${startHour.toString().padStart(2, '0')}:${startMinutes.toString().padStart(2, '0')}:00`;
                    const cell = document.querySelector(`td[data-time="${timeStr}"]`);
                    if (cell) {
                        const eventEl = document.createElement('div');
                        eventEl.className = `event ${event.category}`;
                        eventEl.textContent = `${event.title} (${startHour}:${startMinutes.toString().padStart(2, '0')} - ${endHour}:${endMinutes.toString().padStart(2, '0')})`;
                        cell.appendChild(eventEl);
                    }
                }
            });
        }

        // Manejar clic en celda
        function handleCellClick(event) {
            if (event.target.tagName === 'TD' && event.target.dataset.time) {
                openModal(event.target.dataset.time);
            }
        }

        // Abrir modal para crear evento
        function openModal(datetime) {
            const modal = document.getElementById('event-modal');
            const datetimeInput = document.getElementById('event-datetime');
            datetimeInput.value = datetime.replace(':00', '');
            modal.style.display = 'flex';
        }

        // Cerrar modal
        function closeModal() {
            const modal = document.getElementById('event-modal');
            modal.style.display = 'none';
            document.getElementById('event-title').value = '';
            document.getElementById('event-datetime').value = '';
            document.getElementById('event-duration').value = '60';
            document.getElementById('event-category').value = 'work';
            document.getElementById('event-reminder').value = '5';
        }

        // Guardar evento
        function saveEvent() {
            const title = document.getElementById('event-title').value.trim();
            const datetime = document.getElementById('event-datetime').value;
            const duration = parseInt(document.getElementById('event-duration').value) || 60;
            const category = document.getElementById('event-category').value;
            const reminder = parseInt(document.getElementById('event-reminder').value) || 0;

            if (!title || !datetime) {
                alert('Por favor, completa el t√≠tulo y la fecha/hora.');
                return;
            }

            const start = new Date(datetime);
            const end = new Date(start.getTime() + duration * 60000);

            if (isNaN(start.getTime()) || isNaN(end.getTime())) {
                alert('Fecha inv√°lida. Por favor, verifica.');
                return;
            }

            const event = {
                id: Date.now().toString(),
                start: start.toISOString(),
                end: end.toISOString(),
                title,
                description: '',
                category,
                reminder
            };

            events.push(event);
            saveEvents();
            renderCalendar();
            closeModal();

            // Mostrar animaci√≥n de confirmaci√≥n
            const tooltip = document.createElement('div');
            tooltip.className = 'tooltip';
            tooltip.textContent = '¬°Evento guardado! ‚úî';
            document.body.appendChild(tooltip);
            setTimeout(() => tooltip.remove(), 2000);
        }

        // Verificar recordatorios
        function checkReminders() {
            const now = new Date();
            events.forEach(event => {
                const start = new Date(event.start);
                const reminderTime = new Date(start.getTime() - event.reminder * 60000);
                if (now >= reminderTime && now < start && Notification.permission === 'granted') {
                    new Notification(`Recordatorio: ${event.title}`, {
                        body: `Comienza a las ${start.toLocaleTimeString('es-ES')}`,
                    });
                }
            });
        }

        // Cargar eventos desde localStorage
        function loadEvents() {
            const savedEvents = localStorage.getItem('calendarEvents');
            if (savedEvents) {
                events = JSON.parse(savedEvents).map(event => ({
                    ...event,
                    start: new Date(event.start),
                    end: new Date(event.end)
                }));
            } else {
                // Eventos de ejemplo
                events = [
                    {
                        id: '1',
                        start: new Date(2025, 7, 25, 10, 0), // 25 de agosto de 2025, 10:00
                        end: new Date(2025, 7, 25, 11, 0),
                        title: 'Reuni√≥n de trabajo',
                        description: 'Discusi√≥n semanal del proyecto',
                        category: 'work',
                        reminder: 5
                    },
                    {
                        id: '2',
                        start: new Date(2025, 7, 27, 14, 0), // 27 de agosto de 2025, 14:00
                        end: new Date(2025, 7, 27, 15, 0),
                        title: 'Tarea importante',
                        description: 'Entrega de tarea cr√≠tica',
                        category: 'work',
                        reminder: 10
                    },
                    {
                        id: '3',
                        start: new Date(2025, 7, 15, 9, 0), // 15 de agosto de 2025, 09:00
                        end: new Date(2025, 7, 15, 10, 0),
                        title: 'Cita m√©dica',
                        description: 'Consulta de rutina',
                        category: 'personal',
                        reminder: 15
                    }
                ];
                saveEvents();
            }
        }

        // Guardar eventos en localStorage
        function saveEvents() {
            localStorage.setItem('calendarEvents', JSON.stringify(events));
        }

        // Iniciar la agenda cuando se carga la p√°gina
        window.onload = initAgenda;
    </script>
</body>
</html>